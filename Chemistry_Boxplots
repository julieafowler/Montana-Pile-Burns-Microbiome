## Chemistry Summary Stats & Visualizations in R ##

#### Load Packages ####

library(ggplot2)
library(ggpubr)
library(ggthemr) ## if needed to download, will have to get from GitHub, only needed if using ggthemr('dust')

ggthemr('dust')

## Notes:
## Did outlier removal
## Removed outliers > 3 SDs away from the mean within each soil layer (ash, char, mineral, C mineral)
## Replaced by NAs


#### Set Working Directory ####
setwd("/Users/juliefowler/OneDrive - Colostate/PhD Work/Studies/Burn Piles/Montana Burn Pile Work/Montana-Burn-Piles-Project")


#### Import Files and Create Object ####

## Using subset of chemistry variables
map_file <- read.delim("Chem_LessVariables.txt",header = T,row.names=1,check.names=FALSE)


#### Boxplots w/ Tests of Significance ####

## Ordering variable for ggplot
map_file$Layer <- factor(map_file$Layer, levels = c("Ash", "Organic", "Mineral", "Unburned Mineral"))

## Creating comparisons for tests of significance 
my_comparisons<-list(c('Ash','Organic'),c('Ash','Mineral'),c('Ash','Unburned Mineral'),c('Organic','Mineral'),c('Organic','Unburned Mineral'),c('Mineral','Unburned Mineral'))
my_comparisons_nocontrols<-list(c('Ash','Organic'),c('Ash','Mineral'),c('Organic','Mineral'))
my_comparisons_sites<-list(c("Lonesome Wood Lake", "Lonesome Wood Ridge"), c("Lonesome Wood Lake", "Rendezvous"), c("Lonesome Wood Ridge", "Rendezvous"))



#### DOC ####

## Boxplot by Site then Soil Layer
DOC_bySite <- ggplot(map_file, aes(x = Layer, y = DOC)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 6, hide.ns = TRUE, tip.length = 0.035, bracket.size = 0.5) +
  facet_wrap(~Site) +
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Dissolved Organic Carbon (mg/L)") 

DOC_bySite

## Boxplot by Soil Layer then Site
DOC_byLayer <- ggplot(map_file, aes(x = Site, y = DOC)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Site)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons_sites, method = "wilcox.test", label="p.signif", show.legend = FALSE,
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  facet_wrap(~Layer) + 
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Dissolved Organic Carbon (mg/L)") 

DOC_byLayer

## Boxplot with Combined Sites by Soil Layer
DOC_boxplot <- ggplot(map_file, aes(x = Layer, y = DOC)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  theme(legend.position = "none") + geom_point(aes(shape = Site), color = "black", position=position_jitterdodge(dodge.width=0.5), size=2) +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Dissolved Organic Carbon (mg/L)") 

DOC_boxplot


#### TDN ####

## Boxplot by Site then Soil Layer 
TDN_bySite <- ggplot(map_file, aes(x = Layer, y = TDN)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 6, hide.ns = TRUE, tip.length = 0.035, bracket.size = 0.5) +
  facet_wrap(~Site) +
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Total Dissolved Nitrogen (mg/L)")

TDN_bySite

## Boxplot by Soil Layer then Site
TDN_byLayer <- ggplot(map_file, aes(x = Site, y = TDN)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Site)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons_sites, method = "wilcox.test", label="p.signif", show.legend = FALSE,
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  facet_wrap(~Layer) + 
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Total Dissolved Nitrogen (mg/L)")

TDN_byLayer

## Boxplot with Combined Sites by Soil Layer
TDN_boxplot <- ggplot(map_file, aes(x = Layer, y = TDN)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  theme(legend.position = "none") + geom_point(aes(shape = Site), color = "black", position=position_jitterdodge(dodge.width=0.5), size=2) +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Total Dissolved Nitrogen (mg/L)")

TDN_boxplot


#### pH ####

## Boxplot by Site then Soil Layer 
pH_bySite <- ggplot(map_file, aes(x = Layer, y = pH)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 6, hide.ns = TRUE, tip.length = 0.035, bracket.size = 0.5) +
  facet_wrap(~Site) +
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5))

pH_bySite

## Boxplot by Soil Layer then Site
pH_byLayer <- ggplot(map_file, aes(x = Site, y = pH)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Site)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons_sites, method = "wilcox.test", label="p.signif", show.legend = FALSE,
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  facet_wrap(~Layer) + 
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) 

pH_byLayer

## Boxplot with Combined Sites by Soil Layer
pH_boxplot <- ggplot(map_file, aes(x = Layer, y = pH)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  theme(legend.position = "none") + geom_point(aes(shape = Site), color = "black", position=position_jitterdodge(dodge.width=0.5), size=2) +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) 

pH_boxplot


#### ANC ####

## Boxplot by Site then Soil Layer 
ANC_bySite <- ggplot(map_file, aes(x = Layer, y = ANC)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 6, hide.ns = TRUE, tip.length = 0.035, bracket.size = 0.5) +
  facet_wrap(~Site) +
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Acid Neutralizing Capacity")

ANC_bySite

## Boxplot by Soil Layer then Site
ANC_byLayer <- ggplot(map_file, aes(x = Site, y = ANC)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Site)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons_sites, method = "wilcox.test", label="p.signif", show.legend = FALSE,
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  facet_wrap(~Layer) + 
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Acid Neutralizing Capacity")

ANC_byLayer

## Boxplot with Combined Sites by Soil Layer
ANC_boxplot <- ggplot(map_file, aes(x = Layer, y = ANC)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  theme(legend.position = "none") + geom_point(aes(shape = Site), color = "black", position=position_jitterdodge(dodge.width=0.5), size=2) +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Acid Neutralizing Capacity")

ANC_boxplot


#### EC ####

## Boxplot by Site then Soil Layer 
EC_bySite <- ggplot(map_file, aes(x = Layer, y = EC)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 6, hide.ns = TRUE, tip.length = 0.035, bracket.size = 0.5) +
  facet_wrap(~Site) +
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Electrical Conductivity (uS/cm)")

EC_bySite

## Boxplot by Soil Layer then Site
EC_byLayer <- ggplot(map_file, aes(x = Site, y = EC)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Site)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons_sites, method = "wilcox.test", label="p.signif", show.legend = FALSE,
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  facet_wrap(~Layer) + 
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Electrical Conductivity (uS/cm)")

EC_byLayer

## Boxplot with Combined Sites by Soil Layer
EC_boxplot <- ggplot(map_file, aes(x = Layer, y = EC)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  theme(legend.position = "none") + geom_point(aes(shape = Site), color = "black", position=position_jitterdodge(dodge.width=0.5), size=2) +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Electrical Conductivity (uS/cm)")

EC_boxplot


#### Na ####

## Boxplot by Site then Soil Layer 
Na_bySite <- ggplot(map_file, aes(x = Layer, y = Na)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 6, hide.ns = TRUE, tip.length = 0.035, bracket.size = 0.5) +
  facet_wrap(~Site) +
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Sodium (mg/L)")

Na_bySite

## Boxplot by Soil Layer then Site
Na_byLayer <- ggplot(map_file, aes(x = Site, y = Na)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Site)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons_sites, method = "wilcox.test", label="p.signif", show.legend = FALSE,
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  facet_wrap(~Layer) + 
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Sodium (mg/L)")

Na_byLayer

## Boxplot with Combined Sites by Soil Layer
Na_boxplot <- ggplot(map_file, aes(x = Layer, y = Na)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  theme(legend.position = "none") + geom_point(aes(shape = Site), color = "black", position=position_jitterdodge(dodge.width=0.5), size=2) +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Sodium (mg/L)")

Na_boxplot


#### NH4 ####

## Boxplot by Site then Soil Layer 
NH4_bySite <- ggplot(map_file, aes(x = Layer, y = NH4)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 6, hide.ns = TRUE, tip.length = 0.035, bracket.size = 0.5) +
  facet_wrap(~Site) +
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Ammonium (mg/L)")

NH4_bySite

## Boxplot by Soil Layer then Site
NH4_byLayer <- ggplot(map_file, aes(x = Site, y = NH4)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Site)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons_sites, method = "wilcox.test", label="p.signif", show.legend = FALSE,
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  facet_wrap(~Layer) + 
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Ammonium (mg/L)")

NH4_byLayer

## Boxplot with Combined Sites by Soil Layer
NH4_boxplot <- ggplot(map_file, aes(x = Layer, y = NH4)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  theme(legend.position = "none") + geom_point(aes(shape = Site), color = "black", position=position_jitterdodge(dodge.width=0.5), size=2) +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Ammonium (mg/L)")

NH4_boxplot


#### K ####

## Boxplot by Site then Soil Layer 
K_bySite <- ggplot(map_file, aes(x = Layer, y = K)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 6, hide.ns = TRUE, tip.length = 0.035, bracket.size = 0.5) +
  facet_wrap(~Site) +
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Potassium (mg/L)")

K_bySite

## Boxplot by Soil Layer then Site
K_byLayer <- ggplot(map_file, aes(x = Site, y = K)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Site)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons_sites, method = "wilcox.test", label="p.signif", show.legend = FALSE,
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  facet_wrap(~Layer) + 
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Potassium (mg/L)")

K_byLayer

## Boxplot with Combined Sites by Soil Layer
K_boxplot <- ggplot(map_file, aes(x = Layer, y = K)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  theme(legend.position = "none") + geom_point(aes(shape = Site), color = "black", position=position_jitterdodge(dodge.width=0.5), size=2) +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Potassium (mg/L)")

K_boxplot


#### Mg ####

## Boxplot by Site then Soil Layer 
Mg_bySite <- ggplot(map_file, aes(x = Layer, y = Mg)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 6, hide.ns = TRUE, tip.length = 0.035, bracket.size = 0.5) +
  facet_wrap(~Site) +
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Magnesium (mg/L)")

Mg_bySite

## Boxplot by Soil Layer then Site
Mg_byLayer <- ggplot(map_file, aes(x = Site, y = Mg)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Site)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons_sites, method = "wilcox.test", label="p.signif", show.legend = FALSE,
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  facet_wrap(~Layer) + 
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Magnesium (mg/L)")

Mg_byLayer

## Boxplot with Combined Sites by Soil Layer
Mg_boxplot <- ggplot(map_file, aes(x = Layer, y = Mg)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  theme(legend.position = "none") + geom_point(aes(shape = Site), color = "black", position=position_jitterdodge(dodge.width=0.5), size=2) +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Magnesium (mg/L)")

Mg_boxplot


#### Ca ####

## Boxplot by Site then Soil Layer 
Ca_bySite <- ggplot(map_file, aes(x = Layer, y = Ca)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 6, hide.ns = TRUE, tip.length = 0.035, bracket.size = 0.5) +
  facet_wrap(~Site) +
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Calcium (mg/L)")

Ca_bySite

## Boxplot by Soil Layer then Site
Ca_byLayer <- ggplot(map_file, aes(x = Site, y = Ca)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Site)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons_sites, method = "wilcox.test", label="p.signif", show.legend = FALSE,
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  facet_wrap(~Layer) + 
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Calcium (mg/L)")

Ca_byLayer

## Boxplot with Combined Sites by Soil Layer
Ca_boxplot <- ggplot(map_file, aes(x = Layer, y = Ca)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  theme(legend.position = "none") + geom_point(aes(shape = Site), color = "black", position=position_jitterdodge(dodge.width=0.5), size=2) +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Calcium (mg/L)")

Ca_boxplot 


#### Cl ####

## Boxplot by Site then Soil Layer 
Cl_bySite <- ggplot(map_file, aes(x = Layer, y = Cl)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 6, hide.ns = TRUE, tip.length = 0.035, bracket.size = 0.5) +
  facet_wrap(~Site) +
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Chloride (mg/L)")

Cl_bySite

## Boxplot by Soil Layer then Site
Cl_byLayer <- ggplot(map_file, aes(x = Site, y = Cl)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Site)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons_sites, method = "wilcox.test", label="p.signif", show.legend = FALSE,
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  facet_wrap(~Layer) + 
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Chloride (mg/L)")

Cl_byLayer

## Boxplot with Combined Sites by Soil Layer
Cl_boxplot <- ggplot(map_file, aes(x = Layer, y = Cl)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  theme(legend.position = "none") + geom_point(aes(shape = Site), color = "black", position=position_jitterdodge(dodge.width=0.5), size=2) +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Chloride (mg/L)")

Cl_boxplot


#### NO3 ####

## Boxplot by Site then Soil Layer 
NO3_bySite <- ggplot(map_file, aes(x = Layer, y = NO3)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 6, hide.ns = TRUE, tip.length = 0.035, bracket.size = 0.5) +
  facet_wrap(~Site) +
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Nitrate (mg/L)")

NO3_bySite

## Boxplot by Soil Layer then Site
NO3_byLayer <- ggplot(map_file, aes(x = Site, y = NO3)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Site)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons_sites, method = "wilcox.test", label="p.signif", show.legend = FALSE,
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  facet_wrap(~Layer) + 
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Nitrate (mg/L)")

NO3_byLayer

## Boxplot with Combined Sites by Soil Layer
NO3_boxplot <- ggplot(map_file, aes(x = Layer, y = NO3)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  theme(legend.position = "none") + geom_point(aes(shape = Site), color = "black", position=position_jitterdodge(dodge.width=0.5), size=2) +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Nitrate (mg/L)")

NO3_boxplot


#### PO4 ####

## Boxplot by Site then Soil Layer 
PO4_bySite <- ggplot(map_file, aes(x = Layer, y = PO4)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 6, hide.ns = TRUE, tip.length = 0.035, bracket.size = 0.5) +
  facet_wrap(~Site) +
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Phosphate (mg/L)")

PO4_bySite

## Boxplot by Soil Layer then Site
PO4_byLayer <- ggplot(map_file, aes(x = Site, y = PO4)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Site)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons_sites, method = "wilcox.test", label="p.signif", show.legend = FALSE,
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  facet_wrap(~Layer) + 
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Phosphate (mg/L)")

PO4_byLayer

## Boxplot with Combined Sites by Soil Layer
PO4_boxplot <- ggplot(map_file, aes(x = Layer, y = PO4)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  theme(legend.position = "none") + geom_point(aes(shape = Site), color = "black", position=position_jitterdodge(dodge.width=0.5), size=2) +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Phosphate (mg/L)")

PO4_boxplot


#### SO4 ####

## Boxplot by Site then Soil Layer 
SO4_bySite <- ggplot(map_file, aes(x = Layer, y = SO4)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 6, hide.ns = TRUE, tip.length = 0.035, bracket.size = 0.5) +
  facet_wrap(~Site) +
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Sulfate (mg/L)")

SO4_bySite

## Boxplot by Soil Layer then Site
SO4_byLayer <- ggplot(map_file, aes(x = Site, y = SO4)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Site)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons_sites, method = "wilcox.test", label="p.signif", show.legend = FALSE,
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  facet_wrap(~Layer) + 
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Sulfate (mg/L)")

SO4_byLayer

## Boxplot with Combined Sites by Soil Layer
SO4_boxplot <- ggplot(map_file, aes(x = Layer, y = SO4)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  theme(legend.position = "none") + geom_point(aes(shape = Site), color = "black", position=position_jitterdodge(dodge.width=0.5), size=2) +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Sulfate (mg/L)")

SO4_boxplot


#### NO3-N ####

## Boxplot by Site then Soil Layer 
NO3_N_bySite <- ggplot(map_file, aes(x = Layer, y = map_file$`NO3-N`)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 6, hide.ns = TRUE, tip.length = 0.035, bracket.size = 0.5) +
  facet_wrap(~Site) +
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Nitrate-Nitrogen (mg/L)")

NO3_N_bySite

## Boxplot by Soil Layer then Site
NO3_N_byLayer <- ggplot(map_file, aes(x = Site, y = map_file$`NO3-N`)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Site)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons_sites, method = "wilcox.test", label="p.signif", show.legend = FALSE,
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  facet_wrap(~Layer) + 
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Nitrate-Nitrogen (mg/L)")

NO3_N_byLayer

## Boxplot with Combined Sites by Soil Layer
NO3_N_boxplot <- ggplot(map_file, aes(x = Layer, y = map_file$`NO3-N`)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  theme(legend.position = "none") + geom_point(aes(shape = Site), color = "black", position=position_jitterdodge(dodge.width=0.5), size=2) +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Nitrate-Nitrogen (mg/L)")

NO3_N_boxplot


#### NH4-N ####

## Boxplot by Site then Soil Layer 
NH4_N_bySite <- ggplot(map_file, aes(x = Layer, y = map_file$`NH4-N`)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 6, hide.ns = TRUE, tip.length = 0.035, bracket.size = 0.5) +
  facet_wrap(~Site) +
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Ammonium-Nitrogen (mg/L)")

NH4_N_bySite

## Boxplot by Soil Layer then Site
NH4_N_byLayer <- ggplot(map_file, aes(x = Site, y = map_file$`NH4-N`)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Site)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons_sites, method = "wilcox.test", label="p.signif", show.legend = FALSE,
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  facet_wrap(~Layer) + 
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Ammonium-Nitrogen (mg/L)")

NH4_N_byLayer

## Boxplot with Combined Sites by Soil Layer
NH4_N_boxplot <- ggplot(map_file, aes(x = Layer, y = map_file$`NH4-N`)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  theme(legend.position = "none") + geom_point(aes(shape = Site), color = "black", position=position_jitterdodge(dodge.width=0.5), size=2) +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Ammonium-Nitrogen (mg/L)")

NH4_N_boxplot


#### DIN ####

## Boxplot by Site then Soil Layer 
DIN_bySite <- ggplot(map_file, aes(x = Layer, y = DIN)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 6, hide.ns = TRUE, tip.length = 0.035, bracket.size = 0.5) +
  facet_wrap(~Site) +
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Dissolved Inorganic Nitrogen (mg/L)")

DIN_bySite

## Boxplot by Soil Layer then Site
DIN_byLayer <- ggplot(map_file, aes(x = Site, y = DIN)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Site)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons_sites, method = "wilcox.test", label="p.signif", show.legend = FALSE,
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  facet_wrap(~Layer) + 
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Dissolved Inorganic Nitrogen (mg/L)")

DIN_byLayer

## Boxplot with Combined Sites by Soil Layer
DIN_boxplot <- ggplot(map_file, aes(x = Layer, y = DIN)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  theme(legend.position = "none") + geom_point(aes(shape = Site), color = "black", position=position_jitterdodge(dodge.width=0.5), size=2) +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Dissolved Inorganic Nitrogen (mg/L)")

DIN_boxplot


#### DON ####

## Boxplot by Site then Soil Layer 
DON_bySite <- ggplot(map_file, aes(x = Layer, y = DON)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 6, hide.ns = TRUE, tip.length = 0.035, bracket.size = 0.5) +
  facet_wrap(~Site) +
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Dissolved Organic Nitrogen (mg/L)")

DON_bySite

## Boxplot by Soil Layer then Site
DON_byLayer <- ggplot(map_file, aes(x = Site, y = DON)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Site)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons_sites, method = "wilcox.test", label="p.signif", show.legend = FALSE,
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  facet_wrap(~Layer) + 
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Dissolved Organic Nitrogen (mg/L)")

DON_byLayer

## Boxplot with Combined Sites by Soil Layer
DON_boxplot <- ggplot(map_file, aes(x = Layer, y = DON)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  theme(legend.position = "none") + geom_point(aes(shape = Site), color = "black", position=position_jitterdodge(dodge.width=0.5), size=2) +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Dissolved Organic Nitrogen (mg/L)")

DON_boxplot


#### C_percent ####

## Boxplot by Site then Soil Layer 
C_percent_bySite <- ggplot(map_file, aes(x = Layer, y = C_percent)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 6, hide.ns = TRUE, tip.length = 0.035, bracket.size = 0.5) +
  facet_wrap(~Site) +
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Carbon (%)")

C_percent_bySite

## Boxplot by Soil Layer then Site
C_percent_byLayer <- ggplot(map_file, aes(x = Site, y = C_percent)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Site)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons_sites, method = "wilcox.test", label="p.signif", show.legend = FALSE,
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  facet_wrap(~Layer) + 
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Carbon (%)")

C_percent_byLayer

## Boxplot with Combined Sites by Soil Layer
C_percent_boxplot <- ggplot(map_file, aes(x = Layer, y = C_percent)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  theme(legend.position = "none") + geom_point(aes(shape = Site), color = "black", position=position_jitterdodge(dodge.width=0.5), size=2) +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Carbon (%)")

C_percent_boxplot


#### N_percent ####

## Boxplot by Site then Soil Layer 
N_percent_bySite <- ggplot(map_file, aes(x = Layer, y = N_percent)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 6, hide.ns = TRUE, tip.length = 0.035, bracket.size = 0.5) +
  facet_wrap(~Site) +
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Nitrogen (%)")

N_percent_bySite

## Boxplot by Soil Layer then Site
N_percent_byLayer <- ggplot(map_file, aes(x = Site, y = N_percent)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Site)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons_sites, method = "wilcox.test", label="p.signif", show.legend = FALSE,
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  facet_wrap(~Layer) + 
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Nitrogen (%)")

N_percent_byLayer

## Boxplot with Combined Sites by Soil Layer
N_percent_boxplot <- ggplot(map_file, aes(x = Layer, y = N_percent)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  theme(legend.position = "none") + geom_point(aes(shape = Site), color = "black", position=position_jitterdodge(dodge.width=0.5), size=2) +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("Nitrogen (%)")

N_percent_boxplot


#### CN_Ratio ####

## Boxplot by Site then Soil Layer 
CN_Ratio_bySite <- ggplot(map_file, aes(x = Layer, y = CN_Ratio)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 6, hide.ns = TRUE, tip.length = 0.035, bracket.size = 0.5) +
  facet_wrap(~Site) +
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("C:N Ratio")

CN_Ratio_bySite

## Boxplot by Soil Layer then Site
CN_Ratio_byLayer <- ggplot(map_file, aes(x = Site, y = CN_Ratio)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Site)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons_sites, method = "wilcox.test", label="p.signif", show.legend = FALSE,
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  facet_wrap(~Layer) + 
  theme(strip.text.x = element_text(size = 10, color = "black", face = "bold")) +
  theme(legend.position = "none") + geom_jitter(color = "black") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("C:N Ratio")

CN_Ratio_byLayer

## Boxplot with Combined Sites by Soil Layer
CN_Ratio_boxplot <- ggplot(map_file, aes(x = Layer, y = CN_Ratio)) + geom_boxplot(stat = "boxplot", aes(fill=as.factor(Layer)), outlier.shape = NA) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", label="p.signif", show.legend = FALSE, 
                     size = 5, hide.ns = TRUE, tip.length = 0.04, bracket.size = 0.5) +
  theme(legend.position = "none") + geom_point(aes(shape = Site), color = "black", position=position_jitterdodge(dodge.width=0.5), size=2) +
  xlab("Soil Layer") +
  theme(axis.title.x = element_text(vjust = -0.3)) +
  theme(axis.title.y = element_text(vjust = 1.5)) +
  ylab("C:N Ratio")

CN_Ratio_boxplot





#### Arranging Graphs for Publication #### 

## by Site then Soil Layer
DOC_bySite <- DOC_bySite + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
TDN_bySite <- TDN_bySite + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
DIN_bySite <- DIN_bySite + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
DON_bySite <- DON_bySite + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
NH4_bySite <- NH4_bySite + scale_x_discrete(guide = guide_axis(angle = 45))
NO3_bySite <- NO3_bySite + scale_x_discrete(guide = guide_axis(angle = 45))
CandN_bySite <- ggarrange(DOC_bySite, TDN_bySite, DIN_bySite, DON_bySite, NH4_bySite, NO3_bySite,
                         ncol = 2, nrow = 3, common.legend = TRUE,
                         labels = c("A","B","C","D","E","F"),
                         align = c("hv")) 

CandN_bySite



C_percent_bySite <- C_percent_bySite + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
N_percent_bySite <- N_percent_bySite + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
CN_Ratio_bySite <- CN_Ratio_bySite + scale_x_discrete(guide = guide_axis(angle = 45))
PercentCarbonandNitrogen_bySite <- ggarrange(C_percent_bySite, N_percent_bySite, CN_Ratio_bySite,
                                      ncol = 1, nrow = 3, common.legend = TRUE,
                                      labels = c("A","B","C"),
                                      align = c("hv")) 

PercentCarbonandNitrogen_bySite



pH_bySite <- pH_bySite + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
Na_bySite <- Na_bySite + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
ANC_bySite <- ANC_bySite + scale_x_discrete(guide = guide_axis(angle = 45))
EC_bySite <- EC_bySite + scale_x_discrete(guide = guide_axis(angle = 45))
pH_ANC_EC_bySite <- ggarrange(pH_bySite, Na_bySite, ANC_bySite, EC_bySite,
                       ncol = 2, nrow = 2, common.legend = TRUE,
                       labels = c("A","B","C","D"),
                       align = c("hv")) 

pH_ANC_EC_bySite



PO4_bySite <- PO4_bySite + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
K_bySite <- K_bySite + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
Ca_bySite <- Ca_bySite + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
SO4_bySite <- SO4_bySite + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
Mg_bySite <- Mg_bySite + scale_x_discrete(guide = guide_axis(angle = 45))
Cl_bySite <- Cl_bySite + scale_x_discrete(guide = guide_axis(angle = 45))
Macronutrients_bySite <- ggarrange(PO4_bySite, K_bySite, Ca_bySite, SO4_bySite,
                            Mg_bySite, Cl_bySite,
                            ncol = 2, nrow = 3, common.legend = TRUE,
                            labels = c("A","B","C","D","E","F"),
                            align = c("hv")) 

Macronutrients_bySite



## by Soil Layers then Site 
DOC_byLayer <- DOC_byLayer + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
TDN_byLayer <- TDN_byLayer + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
DIN_byLayer <- DIN_byLayer + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
DON_byLayer <- DON_byLayer + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
NH4_byLayer <- NH4_byLayer + scale_x_discrete(guide = guide_axis(angle = 45))
NO3_byLayer <- NO3_byLayer + scale_x_discrete(guide = guide_axis(angle = 45))
CandN_byLayer <- ggarrange(DOC_byLayer, TDN_byLayer, DIN_byLayer, DON_byLayer, NH4_byLayer, NO3_byLayer,
                          ncol = 2, nrow = 3, common.legend = TRUE,
                          labels = c("A","B","C","D","E","F"),
                          align = c("hv")) 

CandN_byLayer



C_percent_byLayer <- C_percent_byLayer + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
N_percent_byLayer <- N_percent_byLayer + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
CN_Ratio_byLayer <- CN_Ratio_byLayer + scale_x_discrete(guide = guide_axis(angle = 45))
PercentCarbonandNitrogen_byLayer <- ggarrange(C_percent_byLayer, N_percent_byLayer, CN_Ratio_byLayer,
                                             ncol = 1, nrow = 3, common.legend = TRUE,
                                             labels = c("A","B","C"),
                                             align = c("hv")) 

PercentCarbonandNitrogen_byLayer



pH_byLayer <- pH_byLayer + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
Na_byLayer <- Na_byLayer + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
ANC_byLayer <- ANC_byLayer + scale_x_discrete(guide = guide_axis(angle = 45))
EC_byLayer <- EC_byLayer + scale_x_discrete(guide = guide_axis(angle = 45))
pH_ANC_EC_byLayer <- ggarrange(pH_byLayer, Na_byLayer, ANC_byLayer, EC_byLayer,
                              ncol = 2, nrow = 2, common.legend = TRUE,
                              labels = c("A","B","C","D"),
                              align = c("hv")) 

pH_ANC_EC_byLayer



PO4_byLayer <- PO4_byLayer + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
K_byLayer <- K_byLayer + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
Ca_byLayer <- Ca_byLayer + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
SO4_byLayer <- SO4_byLayer + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
Mg_byLayer <- Mg_byLayer + scale_x_discrete(guide = guide_axis(angle = 45))
Cl_byLayer <- Cl_byLayer + scale_x_discrete(guide = guide_axis(angle = 45))
Macronutrients_byLayer <- ggarrange(PO4_byLayer, K_byLayer, Ca_byLayer, SO4_byLayer,
                                   Mg_byLayer, Cl_byLayer,
                                   ncol = 2, nrow = 3, common.legend = TRUE,
                                   labels = c("A","B","C","D","E","F"),
                                   align = c("hv")) 

Macronutrients_byLayer



## Boxplots with Combined Sites by Soil Layers

DOC_boxplot <- DOC_boxplot + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
TDN_boxplot <- TDN_boxplot + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
DIN_boxplot <- DIN_boxplot + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
DON_boxplot <- DON_boxplot + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
CandN <- ggarrange(DOC_boxplot, TDN_boxplot, DIN_boxplot, DON_boxplot, NH4_boxplot, NO3_boxplot,
                                         ncol = 2, nrow = 3, common.legend = TRUE,
                                         labels = c("A","B","C","D","E","F"),
                                         align = c("hv")) 

CandN 



C_percent_boxplot <- C_percent_boxplot + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
N_percent_boxplot <- N_percent_boxplot + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
PercentCarbonandNitrogen <- ggarrange(C_percent_boxplot, N_percent_boxplot, CN_Ratio_boxplot,
                               ncol = 1, nrow = 3, common.legend = TRUE,
                               labels = c("A","B","C"),
                               align = c("hv")) 

PercentCarbonandNitrogen



pH_boxplot <- pH_boxplot + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
Na_boxplot <- Na_boxplot + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
pH_ANC_EC <- ggarrange(pH_boxplot, Na_boxplot, ANC_boxplot, EC_boxplot,
                       ncol = 2, nrow = 2, common.legend = TRUE,
                       labels = c("A","B","C"),
                       align = c("hv")) 
  
pH_ANC_EC



PO4_boxplot <- PO4_boxplot + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
K_boxplot <- K_boxplot + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
Ca_boxplot <- Ca_boxplot + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
SO4_boxplot <- SO4_boxplot + theme(axis.title.x = element_blank(), axis.text.x=element_blank())
Macronutrients <- ggarrange(PO4_boxplot, K_boxplot, Ca_boxplot, SO4_boxplot,
                            Mg_boxplot, Cl_boxplot,
                            ncol = 2, nrow = 3, common.legend = TRUE,
                            labels = c("A","B","C","D","E","F"),
                            align = c("hv")) 

Macronutrients





